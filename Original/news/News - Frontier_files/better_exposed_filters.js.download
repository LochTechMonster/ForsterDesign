(function($){Drupal.behaviors.betterExposedFilters={attach:function(context){$('.bef-tree input[type=checkbox], .bef-checkboxes input[type=checkbox]').change(function(){_bef_highlight(this,context);}).filter(':checked').closest('.form-item',context).addClass('highlight');}};Drupal.behaviors.betterExposedFiltersSelectAllNone={attach:function(context){var selected=$('.form-checkboxes.bef-select-all-none:not(.bef-processed)');if(selected.length){var selAll=Drupal.t('Select All');var selNone=Drupal.t('Select None');var link=$('<a class="bef-toggle" href="#">'+selAll+'</a>')
link.click(function(event){event.preventDefault();event.stopPropagation();if(selAll==$(this).text()){$(this).html(selNone).siblings('.bef-checkboxes, .bef-tree').find('.form-item input:checkbox').each(function(){$(this).attr('checked',true);_bef_highlight(this,context);}).end().find('input[type=checkbox]:first').change();}else{$(this).html(selAll).siblings('.bef-checkboxes, .bef-tree').find('.form-item input:checkbox').each(function(){$(this).attr('checked',false);_bef_highlight(this,context);}).end().find('input[type=checkbox]:first').change();}});selected.addClass('bef-processed').each(function(index){var newLink=link.clone(true);newLink.insertBefore($('.bef-checkboxes, .bef-tree',this));if($('input:checkbox:checked',this).length==$('input:checkbox',this).length){newLink.click();}});}var befSettings=Drupal.settings.better_exposed_filters;if(befSettings&&befSettings.datepicker&&befSettings.datepicker_options&&$.fn.datepicker){var opt=[];$.each(befSettings.datepicker_options,function(key,val){if(key&&val){opt[key]=JSON.parse(val);}});$('.bef-datepicker').datepicker(opt);}}};Drupal.behaviors.betterExposedFiltersAllNoneNested={attach:function(context,settings){$('.form-checkboxes.bef-select-all-none-nested li').has('ul').once('bef-all-none-nested',function(){$(this).find('input.form-checkboxes:first').click(function(){var checkedParent=$(this).attr('checked');if(!checkedParent){$(this).parents('li:first').find('ul input.form-checkboxes').removeAttr('checked');}else{$(this).parents('li:first').find('ul input.form-checkboxes').attr('checked',$(this).attr('checked'));}}).end().find('ul input.form-checkboxes').click(function(){var checked=$(this).attr('checked');var ct=$(this).parents('ul:first').find('input.form-checkboxes:not(:checked)').size();if(!checked){$(this).parents('li:first').parents('li:first').find('input.form-checkboxes:first').removeAttr('checked');}if(!ct){$(this).parents('li:first').parents('li:first').find('input.form-checkboxes:first').attr('checked',checked);}});});}};Drupal.behaviors.better_exposed_filters_slider={attach:function(context,settings){var befSettings=settings.better_exposed_filters;if(befSettings&&befSettings.slider&&befSettings.slider_options){$.each(befSettings.slider_options,function(i,sliderOptions){var containing_parent="#"+sliderOptions.viewId+" #edit-"+sliderOptions.id+"-wrapper .views-widget";var $filter=$(containing_parent);if(!$filter.length){containing_parent="#"+sliderOptions.viewId+" .bef-slider-wrapper";$filter=$(containing_parent);}$filter.once('slider-filter',function(){var $input=$(this).find('input[type=text]');if($input.length==2){var $min=$input.parent().find('input#edit-'+sliderOptions.id+'-min'),$max=$input.parent().find('input#edit-'+sliderOptions.id+'-max'),default_min,default_max;if(!$min.length||!$max.length){return;}default_min=parseFloat(($min.val()=='')?sliderOptions.min:$min.val(),10);default_max=parseFloat(($max.val()=='')?sliderOptions.max:$max.val(),10);$min.val(default_min);$max.val(default_max);$min.parents(containing_parent).after($('<div class="bef-slider"></div>').slider({range:true,min:parseFloat(sliderOptions.min,10),max:parseFloat(sliderOptions.max,10),step:parseFloat(sliderOptions.step,10),animate:sliderOptions.animate?sliderOptions.animate:false,orientation:sliderOptions.orientation,values:[default_min,default_max],slide:function(event,ui){$min.val(ui.values[0]);$max.val(ui.values[1]);},change:function(event,ui){$min.val(ui.values[0]);$max.val(ui.values[1]);},stop:function(event,ui){$(this).parents('form').find('.ctools-auto-submit-click').click();}}));$min.blur(function(){befUpdateSlider($(this),0,sliderOptions);});$max.blur(function(){befUpdateSlider($(this),1,sliderOptions);});}else if($input.length==1){if($input.attr('id')!='edit-'+sliderOptions.id){return;}var default_value=parseFloat(($input.val()=='')?sliderOptions.min:$input.val(),10);$input.val(default_value);$input.parents(containing_parent).after($('<div class="bef-slider"></div>').slider({min:parseFloat(sliderOptions.min,10),max:parseFloat(sliderOptions.max,10),step:parseFloat(sliderOptions.step,10),animate:sliderOptions.animate?sliderOptions.animate:false,orientation:sliderOptions.orientation,value:default_value,slide:function(event,ui){$input.val(ui.value);},change:function(event,ui){$input.val(ui.value);},stop:function(event,ui){$(this).parents('form').find('.ctools-auto-submit-click').click();}}));$input.blur(function(){befUpdateSlider($(this),null,sliderOptions);});}else{return;}})});}}};Drupal.behaviors.better_exposed_filters_select_as_links={attach:function(context,settings){$('.bef-select-as-links',context).once(function(){var $element=$(this);if(typeof settings.views=='undefined'||typeof settings.views.ajaxViews=='undefined'){return;}var $uses_ajax=false;$.each(settings.views.ajaxViews,function(i,item){var $view_name=item.view_name.replace(/_/g,'-');var $view_display_id=item.view_display_id.replace(/_/g,'-');var $id='views-exposed-form-'+$view_name+'-'+$view_display_id;var $form_id=$element.parents('form').attr('id');if($form_id==$id){$uses_ajax=true;return;}});if(!$uses_ajax){return;}$(this).find('a').click(function(event){var $wrapper=$(this).parents('.bef-select-as-links');var $options=$wrapper.find('select option');event.preventDefault();event.stopPropagation();$wrapper.find('select option').removeAttr('selected');var link_text=$(this).text();$selected=$options.filter(function(){return $(this).text()==link_text;});$selected.attr('selected','selected');$wrapper.find('.bef-new-value').val($selected.val());$wrapper.find('a').removeClass('active');$(this).addClass('active');$wrapper.parents('form').find('.views-submit-button *[type=submit]').click();});});}};Drupal.behaviors.betterExposedFiltersRequiredFilter={attach:function(context,settings){$('.bef-select-as-checkboxes',context).once('bef-required-filter').ajaxComplete(function(e,xhr,s){var $element=$(this);if(typeof settings.views=='undefined'||typeof settings.views.ajaxViews=='undefined'){return;}var $view_name;var $view_display_id;var $uses_ajax=false;$.each(settings.views.ajaxViews,function(i,item){$view_name=item.view_name;$view_display_id=item.view_display_id;var $id='views-exposed-form-'+$view_name.replace(/_/g,'-')+'-'+$view_display_id.replace(/_/g,'-');var $form_id=$element.parents('form').attr('id');if($form_id==$id){$uses_ajax=true;return false;}});if($('input',this).length>0){var $filter_name=$('input',this).attr('name').slice(0,-2);if(Drupal.settings.better_exposed_filters.views[$view_name].displays[$view_display_id].filters[$filter_name].required&&$('input:checked',this).length==0){$('input',this).prop('checked',true);}}});}}
function _bef_highlight(elem,context){$elem=$(elem,context);$elem.attr('checked')?$elem.closest('.form-item',context).addClass('highlight'):$elem.closest('.form-item',context).removeClass('highlight');}function befUpdateSlider($el,valIndex,sliderOptions){var val=parseFloat($el.val(),10),currentMin=$el.parents('div.views-widget').next('.bef-slider').slider('values',0),currentMax=$el.parents('div.views-widget').next('.bef-slider').slider('values',1);if(valIndex!=null){if(valIndex==0&&val>currentMax){val=currentMax;}if(valIndex==1&&val<currentMin){val=currentMin;}if(isNaN(val)){val=$el.parents('div.views-widget').next('.bef-slider').slider('values',valIndex);}}else{if(isNaN(val)){val=$el.parents('div.views-widget').next('.bef-slider').slider('value');}}val=parseFloat(val,10);if(valIndex!=null){$el.parents('div.views-widget').next('.bef-slider').slider('values',valIndex,val);}else{$el.parents('div.views-widget').next('.bef-slider').slider('value',val);}}})(jQuery);